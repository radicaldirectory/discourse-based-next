{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useSWRInfinite } from \"swr\";\nimport Layout from \"@components/Layout\";\nimport TopicListItem from \"@components/TopicListItem\";\nimport { getCategories } from \"@api/categories\";\n\nvar fetcher = function fetcher() {\n  return fetch.apply(void 0, arguments).then(function (res) {\n    return res.json();\n  });\n};\n\nvar PAGE_SIZE = 30; //-----------------------------------------------------------------------------\n\nfunction TopicListPage(_ref) {\n  var topicList = _ref.topicList;\n  //console.log(\"topiclist =\");\n  //console.log(topicList);\n  return __jsx(\"div\", null, topicList.map(function (value, index) {\n    return __jsx(TopicListItem, {\n      key: index,\n      value: value\n    });\n  }));\n} //-----------------------------------------------------------------------------\n\n\nfunction TopicList(_ref2) {\n  var _ref3, _data$, _data;\n\n  var categories = _ref2.categories;\n  var router = useRouter();\n  var id = router.query.id; //console.log(\"ID = \" + id);\n\n  var _useSWRInfinite = useSWRInfinite(function (index) {\n    return \"/api/c/\".concat(id, \"?page=\").concat(index);\n  }, fetcher),\n      data = _useSWRInfinite.data,\n      error = _useSWRInfinite.error,\n      mutate = _useSWRInfinite.mutate,\n      size = _useSWRInfinite.size,\n      setSize = _useSWRInfinite.setSize,\n      isValidating = _useSWRInfinite.isValidating;\n\n  var topicsPages = data ? (_ref3 = []).concat.apply(_ref3, _toConsumableArray(data)) : []; //console.log(topicsPages);\n\n  var isLoadingInitialData = !data && !error;\n  var isLoadingMore = isLoadingInitialData || size > 0 && data && typeof data[size - 1] === \"undefined\";\n  var isEmpty = (data === null || data === void 0 ? void 0 : (_data$ = data[0]) === null || _data$ === void 0 ? void 0 : _data$.length) === 0;\n  var isReachingEnd = isEmpty || data && ((_data = data[data.length - 1]) === null || _data === void 0 ? void 0 : _data.length) < PAGE_SIZE;\n  var isRefreshing = isValidating && data && data.length === size;\n  return (// <Layout categories={categories}>\n    __jsx(React.Fragment, null, __jsx(\"ul\", {\n      className: \"self-center mt-5 topic-list\"\n    }, isEmpty ? __jsx(\"p\", null, \"No topics found.\") : null, topicsPages.map(function (topicsPage) {\n      //console.log(\"topicspage before pass = \");\n      //console.log(topicsPage);\n      return __jsx(TopicListPage, {\n        key: topicsPage.id,\n        topicList: topicsPage.topicList\n      });\n    })), __jsx(\"p\", null, __jsx(\"button\", {\n      className: \"ml-2 btn-blue\",\n      disabled: isLoadingMore || isReachingEnd,\n      onClick: function onClick() {\n        return setSize(size + 1);\n      }\n    }, isLoadingMore ? \"loading...\" : isReachingEnd ? \"no more topics\" : \"load more\"), __jsx(\"button\", {\n      className: \"ml-2 btn-blue\",\n      disabled: isRefreshing,\n      onClick: function onClick() {\n        return mutate();\n      }\n    }, isRefreshing ? \"refreshing...\" : \"refresh\"), __jsx(\"button\", {\n      className: \"ml-2 btn-blue\",\n      disabled: !size,\n      onClick: function onClick() {\n        return setSize(0);\n      }\n    }, \"clear\"), __jsx(\"span\", {\n      className: \"ml-2 italic text-gray-600\"\n    }, \"Showing \", size, \" page(s) of \", isLoadingMore ? \"...\" : topicsPages.length, \" \", \"topic(s)\", \" \"))) // </Layout>\n\n  );\n} // export async function getStaticProps() {\n//   const categories = await getCategories();\n//   return {\n//     props: {\n//       categories,\n//     },\n//   };\n// }\n\n\nexport default TopicList;","map":null,"metadata":{},"sourceType":"module"}